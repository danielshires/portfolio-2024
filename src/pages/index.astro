---
import Layout from '../layouts/Layout.astro'
import Hero from '../components/Hero/Hero.astro'
import ProjectGrid from '../components/ProjectGrid/ProjectGrid.astro'
import { getAuthorBySlug, getAllProjects, getFeaturedProjects, urlFor } from '../lib/sanity'

const author = await getAuthorBySlug('daniel-shires')
const avatarUrl = author?.image ? urlFor(author.image).width(192).height(192).url() : undefined

const heroContent = {
  name:'',
  tagline: 'Design with purpose',
  intro: `Hi, I'm Dan — a Product Designer with 5+ years experience designing cohesive, user-centered digital products.`,
  avatar: avatarUrl,
}

// Get projects from Sanity
const allProjects = await getAllProjects()
const featuredProjects = await getFeaturedProjects()

// Use featured projects if available, otherwise show first 6 regular projects
const projectsToShow = featuredProjects.length > 0 ? featuredProjects.slice(0, 6) : allProjects.slice(0, 6)
---

<Layout
  pageTitle='Daniel Shires | Product Designer based in Sydney currently working for Commonwealth Bank'
  pageDescription='UX/UI Designer and Front-End Developer based in Sydney Australia. I use the principles of human centred design to create simple, impactful experiences in pixels and code.'>
  <main class='grid gap-8 overflow-hidden h-max'>
    <Hero {...heroContent} />
    <div class='mt-auto'>
      <ProjectGrid projects={projectsToShow} />
    </div>
  </main>
</Layout>

<script>
  import ScrollReveal from 'scrollreveal'


  function revealSection() {
    const featuredWork = document.getElementById('featuredWork')
    const sectionThree = document.getElementById('sectionThree')

    const animationOptions = {
      duration: 1200,
      delay: 200,
      distance: '0px',
      opacity: 0,
      easing: 'ease-in-out',
      origin: 'bottom',
    }

    ScrollReveal().reveal(featuredWork, animationOptions)
    ScrollReveal().reveal(sectionThree, animationOptions)
  }

  // Use requestAnimationFrame for better performance
  window.addEventListener('load', () => {
    requestAnimationFrame(() => {
      revealSection()
    })
  })
</script>
