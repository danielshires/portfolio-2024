---
import { urlFor } from '../../lib/sanity'
import type { Album } from '../../lib/sanity'
import Image from 'astro/components/Image.astro'

interface Props {
  album: Album
}

const { album } = Astro.props

// Format the date
const formatDate = (dateString: string) => {
  const date = new Date(dateString)
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  })
}
---

<a
  href={`/pictures/albums/${album.slug.current}`}
  class='block relative overflow-hidden bg-white/5 backdrop-blur-sm border border-white/10 hover:border-white/20 transition-all duration-300 rounded-lg hover:shadow-lg'>
  {
    album.coverImage && (
      <div class='w-full h-64 overflow-hidden'>
        <Image
          src={urlFor(album.coverImage).width(800).url()}
          alt={album.title}
          width={800}
          height={600}
          loading='lazy'
          decoding='async'
          class='object-cover w-full h-full'
        />
      </div>
    )
  }
  <div class='p-4'>
    <h3 class='text-lg font-medium'>{album.title}</h3>
    {
      album.description && (
        <p class='mt-2 text-sm text-gray-600 line-clamp-2'>{album.description}</p>
      )
    }
    <div class='mt-2 flex items-center justify-between text-sm text-gray-500'>
      <span>{album.pictures.length} photos</span>
      <span>{formatDate(album.publishedAt)}</span>
    </div>
  </div>
</a>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
